nohup: ignoring input
2026/02/27 04:27:29 Applied schema.sql successfully.
2026/02/27 04:27:29 PostgreSQL connected successfully.
2026/02/27 04:27:29 Starting background async ingestion workers...
[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.

[GIN-debug] [WARNING] Running in "debug" mode. Switch to "release" mode in production.
 - using env:	export GIN_MODE=release
 - using code:	gin.SetMode(gin.ReleaseMode)

[GIN-debug] GET    /api/v1/health            --> main.main.func1 (3 handlers)
[GIN-debug] GET    /api/v1/recommendation    --> main.handleRecommendation (3 handlers)
[GIN-debug] POST   /api/v1/chat              --> main.handleChat (3 handlers)
[GIN-debug] POST   /api/v1/webhook/whatsapp  --> main.handleWhatsAppWebhook (3 handlers)
2026/02/27 04:27:29 üöÄ AgriChain API listening on 0.0.0.0:8080
[GIN-debug] [WARNING] You trusted all proxies, this is NOT safe. We recommend you to set a value.
Please check https://github.com/gin-gonic/gin/blob/master/docs/doc.md#dont-trust-all-proxies for details.
[GIN-debug] Listening and serving HTTP on 0.0.0.0:8080
2026/02/27 04:27:29 [worker] Fetching data.gov.in live prices...
2026/02/27 04:27:29 [worker] Fetching Open-Meteo weather updates...
2026/02/27 04:27:39 [worker] Failed to fetch live prices for Tomato: data.gov.in request failed: Get "https://api.data.gov.in/resource/9ef84268-d588-465a-a308-a864a43d0070?api-key=579b464db66ec23bdd0000011380f4db44c14e7676f2d1587ed61b2c&format=json&filters[commodity]=Tomato&sort[arrival_date]=desc&limit=10": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
2026/02/27 04:27:49 [worker] Failed to fetch live prices for Wheat: data.gov.in request failed: Get "https://api.data.gov.in/resource/9ef84268-d588-465a-a308-a864a43d0070?api-key=579b464db66ec23bdd0000011380f4db44c14e7676f2d1587ed61b2c&format=json&filters[commodity]=Wheat&sort[arrival_date]=desc&limit=10": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
2026/02/27 04:27:59 [worker] Failed to fetch live prices for Rice: data.gov.in request failed: Get "https://api.data.gov.in/resource/9ef84268-d588-465a-a308-a864a43d0070?api-key=579b464db66ec23bdd0000011380f4db44c14e7676f2d1587ed61b2c&format=json&filters[commodity]=Rice&sort[arrival_date]=desc&limit=10": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
2026/02/27 04:27:59 [worker] Completed mandi price ingestion cycle.
2026/02/27 04:28:30 Chat SLM API failed. Status: 429, err: <nil>, Body: {
  "error": {
    "code": 429,
    "message": "You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash\nPlease retry in 30.014562742s.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Learn more about Gemini API quotas",
            "url": "https://ai.google.dev/gemini-api/docs/rate-limits"
          }
        ]
      },
      {
        "@type": "type.googleapis.com/google.rpc.QuotaFailure",
        "violations": [
          {
            "quotaMetric": "generativelanguage.googleapis.com/generate_content_free_tier_requests",
            "quotaId": "GenerateRequestsPerDayPerProjectPerModel-FreeTier",
            "quotaDimensions": {
              "location": "global",
              "model": "gemini-2.5-flash"
            },
            "quotaValue": "20"
          }
        ]
      },
      {
        "@type": "type.googleapis.com/google.rpc.RetryInfo",
        "retryDelay": "30s"
      }
    ]
  }
}
[GIN] 2026/02/27 - 04:28:30 | 200 |  2.002210726s |       127.0.0.1 | POST     "/api/v1/chat"
2026/02/27 04:29:39 Chat SLM API failed. Status: 429, err: <nil>, Body: {
  "error": {
    "code": 429,
    "message": "You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash\nPlease retry in 21.487404155s.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Learn more about Gemini API quotas",
            "url": "https://ai.google.dev/gemini-api/docs/rate-limits"
          }
        ]
      },
      {
        "@type": "type.googleapis.com/google.rpc.QuotaFailure",
        "violations": [
          {
            "quotaMetric": "generativelanguage.googleapis.com/generate_content_free_tier_requests",
            "quotaId": "GenerateRequestsPerDayPerProjectPerModel-FreeTier",
            "quotaDimensions": {
              "location": "global",
              "model": "gemini-2.5-flash"
            },
            "quotaValue": "20"
          }
        ]
      },
      {
        "@type": "type.googleapis.com/google.rpc.RetryInfo",
        "retryDelay": "21s"
      }
    ]
  }
}
[GIN] 2026/02/27 - 04:29:39 | 200 |  1.455324555s |       127.0.0.1 | POST     "/api/v1/chat"
2026/02/27 04:29:41 Chat SLM API failed. Status: 429, err: <nil>, Body: {
  "error": {
    "code": 429,
    "message": "You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash\nPlease retry in 18.592581387s.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Learn more about Gemini API quotas",
            "url": "https://ai.google.dev/gemini-api/docs/rate-limits"
          }
        ]
      },
      {
        "@type": "type.googleapis.com/google.rpc.QuotaFailure",
        "violations": [
          {
            "quotaMetric": "generativelanguage.googleapis.com/generate_content_free_tier_requests",
            "quotaId": "GenerateRequestsPerDayPerProjectPerModel-FreeTier",
            "quotaDimensions": {
              "location": "global",
              "model": "gemini-2.5-flash"
            },
            "quotaValue": "20"
          }
        ]
      },
      {
        "@type": "type.googleapis.com/google.rpc.RetryInfo",
        "retryDelay": "18s"
      }
    ]
  }
}
[GIN] 2026/02/27 - 04:29:41 | 200 |  889.002207ms |       127.0.0.1 | POST     "/api/v1/chat"
2026/02/27 04:30:00 Chat SLM API failed. Status: 429, err: <nil>, Body: {
  "error": {
    "code": 429,
    "message": "You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash\nPlease retry in 362.798901ms.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Learn more about Gemini API quotas",
            "url": "https://ai.google.dev/gemini-api/docs/rate-limits"
          }
        ]
      },
      {
        "@type": "type.googleapis.com/google.rpc.QuotaFailure",
        "violations": [
          {
            "quotaMetric": "generativelanguage.googleapis.com/generate_content_free_tier_requests",
            "quotaId": "GenerateRequestsPerDayPerProjectPerModel-FreeTier",
            "quotaDimensions": {
              "location": "global",
              "model": "gemini-2.5-flash"
            },
            "quotaValue": "20"
          }
        ]
      },
      {
        "@type": "type.googleapis.com/google.rpc.RetryInfo",
        "retryDelay": "0s"
      }
    ]
  }
}
[GIN] 2026/02/27 - 04:30:00 | 200 |  880.227513ms |       127.0.0.1 | POST     "/api/v1/chat"
2026/02/27 04:31:18 Chat SLM API failed. Status: 429, err: <nil>, Body: {
  "error": {
    "code": 429,
    "message": "You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash\nPlease retry in 41.873337185s.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Learn more about Gemini API quotas",
            "url": "https://ai.google.dev/gemini-api/docs/rate-limits"
          }
        ]
      },
      {
        "@type": "type.googleapis.com/google.rpc.QuotaFailure",
        "violations": [
          {
            "quotaMetric": "generativelanguage.googleapis.com/generate_content_free_tier_requests",
            "quotaId": "GenerateRequestsPerDayPerProjectPerModel-FreeTier",
            "quotaDimensions": {
              "location": "global",
              "model": "gemini-2.5-flash"
            },
            "quotaValue": "20"
          }
        ]
      },
      {
        "@type": "type.googleapis.com/google.rpc.RetryInfo",
        "retryDelay": "41s"
      }
    ]
  }
}
[GIN] 2026/02/27 - 04:31:18 | 200 |  1.181032802s |       127.0.0.1 | POST     "/api/v1/chat"
2026/02/27 04:31:20 Chat SLM API failed. Status: 429, err: <nil>, Body: {
  "error": {
    "code": 429,
    "message": "You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash\nPlease retry in 39.440377818s.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Learn more about Gemini API quotas",
            "url": "https://ai.google.dev/gemini-api/docs/rate-limits"
          }
        ]
      },
      {
        "@type": "type.googleapis.com/google.rpc.QuotaFailure",
        "violations": [
          {
            "quotaMetric": "generativelanguage.googleapis.com/generate_content_free_tier_requests",
            "quotaId": "GenerateRequestsPerDayPerProjectPerModel-FreeTier",
            "quotaDimensions": {
              "location": "global",
              "model": "gemini-2.5-flash"
            },
            "quotaValue": "20"
          }
        ]
      },
      {
        "@type": "type.googleapis.com/google.rpc.RetryInfo",
        "retryDelay": "39s"
      }
    ]
  }
}
[GIN] 2026/02/27 - 04:31:20 | 200 |  1.215844077s |       127.0.0.1 | POST     "/api/v1/chat"
2026/02/27 04:48:52 Chat SLM API failed. Status: 429, err: <nil>, Body: {
  "error": {
    "code": 429,
    "message": "You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. \n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash\nPlease retry in 8.086782275s.",
    "status": "RESOURCE_EXHAUSTED",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Learn more about Gemini API quotas",
            "url": "https://ai.google.dev/gemini-api/docs/rate-limits"
          }
        ]
      },
      {
        "@type": "type.googleapis.com/google.rpc.QuotaFailure",
        "violations": [
          {
            "quotaMetric": "generativelanguage.googleapis.com/generate_content_free_tier_requests",
            "quotaId": "GenerateRequestsPerDayPerProjectPerModel-FreeTier",
            "quotaDimensions": {
              "location": "global",
              "model": "gemini-2.5-flash"
            },
            "quotaValue": "20"
          }
        ]
      },
      {
        "@type": "type.googleapis.com/google.rpc.RetryInfo",
        "retryDelay": "8s"
      }
    ]
  }
}
[GIN] 2026/02/27 - 04:48:52 | 200 |  2.529727664s |       127.0.0.1 | POST     "/api/v1/chat"
[GIN] 2026/02/27 - 04:53:29 | 200 |  5.300142161s |       127.0.0.1 | POST     "/api/v1/chat"
2026/02/27 05:05:50 üìç Using location: lat=21.1830, lon=79.1135
2026/02/27 05:05:50 ‚ö† DB fetch weather failed: pq: column "location" does not exist at position 4:13 (42703)
2026/02/27 05:05:50 ‚ö† DB fetch mandi prices failed: <nil>
2026/02/27 05:05:58 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:05:58 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:05:58 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:05:58 ‚ö† OSRM API failed ‚Äì using haversine fallback
[GIN] 2026/02/27 - 05:05:58 | 200 |  7.366750756s |       127.0.0.1 | GET      "/api/v1/recommendation?farmer_id=a1b2c3d4-e5f6-7890-abcd-ef1234567890&crop_id=c3d4e5f6-a7b8-9012-cdef-123456789012&lang=en&lat=21.182971&lon=79.113482"
2026/02/27 05:06:52 üìç Using location: lat=21.1676, lon=79.0689
2026/02/27 05:06:52 ‚ö† DB fetch weather failed: pq: column "location" does not exist at position 4:13 (42703)
2026/02/27 05:06:52 ‚ö† DB fetch mandi prices failed: <nil>
2026/02/27 05:07:02 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:07:02 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:07:02 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:07:02 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:07:22 üìç Using location: lat=21.1676, lon=79.0689
2026/02/27 05:07:22 ‚ö† DB fetch weather failed: pq: column "location" does not exist at position 4:13 (42703)
2026/02/27 05:07:22 ‚ö† DB fetch mandi prices failed: <nil>
[GIN] 2026/02/27 - 05:07:27 | 200 | 34.376304353s |       127.0.0.1 | GET      "/api/v1/recommendation?farmer_id=a1b2c3d4-e5f6-7890-abcd-ef1234567890&crop_id=c3d4e5f6-a7b8-9012-cdef-123456789012&lang=brx&lat=21.167572&lon=79.068928"
2026/02/27 05:07:31 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:07:31 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:07:31 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:07:31 ‚ö† OSRM API failed ‚Äì using haversine fallback
[GIN] 2026/02/27 - 05:07:44 | 200 | 21.982816315s |       127.0.0.1 | GET      "/api/v1/recommendation?farmer_id=a1b2c3d4-e5f6-7890-abcd-ef1234567890&crop_id=c3d4e5f6-a7b8-9012-cdef-123456789012&lang=brx&lat=21.167572&lon=79.068928"
2026/02/27 05:09:25 üìç Using location: lat=21.1676, lon=79.0689
2026/02/27 05:09:25 ‚ö† DB fetch weather failed: pq: column "location" does not exist at position 4:13 (42703)
2026/02/27 05:09:25 ‚ö† DB fetch mandi prices failed: <nil>
2026/02/27 05:09:31 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:09:31 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:09:31 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:09:31 ‚ö† OSRM API failed ‚Äì using haversine fallback
[GIN] 2026/02/27 - 05:09:45 | 200 | 19.806853932s |       127.0.0.1 | GET      "/api/v1/recommendation?farmer_id=a1b2c3d4-e5f6-7890-abcd-ef1234567890&crop_id=c3d4e5f6-a7b8-9012-cdef-123456789012&lang=brx&lat=21.167572&lon=79.068928"
[GIN] 2026/02/27 - 05:09:52 | 200 |  9.125029389s |       127.0.0.1 | POST     "/api/v1/chat"
2026/02/27 05:10:16 üìç Using location: lat=21.1676, lon=79.0689
2026/02/27 05:10:16 ‚ö† DB fetch weather failed: pq: column "location" does not exist at position 4:13 (42703)
2026/02/27 05:10:16 ‚ö† DB fetch mandi prices failed: <nil>
2026/02/27 05:10:22 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:10:22 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:10:22 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:10:22 ‚ö† OSRM API failed ‚Äì using haversine fallback
[GIN] 2026/02/27 - 05:10:22 | 200 |  5.939863269s |       127.0.0.1 | GET      "/api/v1/recommendation?farmer_id=a1b2c3d4-e5f6-7890-abcd-ef1234567890&crop_id=c3d4e5f6-a7b8-9012-cdef-123456789012&lang=en&lat=21.167572&lon=79.068928"
2026/02/27 05:11:04 ‚ö† DB fetch crop failed: sql: no rows in result set ‚Äì using fallback
2026/02/27 05:11:04 üìç Using location: lat=21.1676, lon=79.0689
2026/02/27 05:11:04 ‚ö† DB fetch weather failed: pq: column "location" does not exist at position 4:13 (42703)
2026/02/27 05:11:04 ‚ö† DB fetch mandi prices failed: <nil>
2026/02/27 05:11:10 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:11:10 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:11:10 ‚ö† OSRM API failed ‚Äì using haversine fallback
2026/02/27 05:11:10 ‚ö† OSRM API failed ‚Äì using haversine fallback
[GIN] 2026/02/27 - 05:11:10 | 200 |  6.164998519s |       127.0.0.1 | GET      "/api/v1/recommendation?farmer_id=a1b2c3d4-e5f6-7890-abcd-ef1234567890&crop_id=a1b2c3d4-5678-2345-7890-123456789012&lang=en&lat=21.167572&lon=79.068928"
2026/02/27 05:27:29 [worker] Fetching Open-Meteo weather updates...

---
phase: 2
plan: 1
wave: 1
---

# Plan 2.1: Frontend Data Integration

## Objective
Update the Flutter frontend `api_service.dart` and `main.dart` to consume and render the dynamic `price_trend_pct` field and properly display the new `why` structure, linking the backend's predictive modeling logic into the app UI.

## Context
- .gsd/SPEC.md
- /home/endertrailer/agrichain/frontend/lib/api_service.dart
- /home/endertrailer/agrichain/frontend/lib/main.dart

## Tasks

<task type="auto" effort="low">
  <name>Update API Service Data Models</name>
  <files>/home/endertrailer/agrichain/frontend/lib/api_service.dart</files>
  <action>
    Add the `priceTrendPct` property to the `MarketOption` class tracking the backend's new `price_trend_pct` field.
    Update the `fromJson` factory and the `_fallbackRecommendation` method to supply a mock value for this new field.
  </action>
  <verify>dart build / flutter analyze</verify>
  <done>api_service.dart compiles correctly with the new field</done>
</task>

<task type="auto" effort="medium">
  <name>Render Price Trends & Preservation in UI</name>
  <files>/home/endertrailer/agrichain/frontend/lib/main.dart</files>
  <action>
    Modify the UI where `MarketOption` are displayed to show `priceTrendPct` (e.g. 'Trend: +17.6%') ideally with color coding (Green for positive, Red for negative).
    Ensure the "Why" section renders the `getWhyForLang()` properly.
  </action>
  <verify>flutter run (re-compile locally to ensure no syntax errors)</verify>
  <done>Frontend displays the price trend dynamically generated by the backend regressions</done>
</task>

## Success Criteria
- [ ] Data models map accurately to the new JSON backend schema.
- [ ] UI highlights the ML regression trends with clear UX.
